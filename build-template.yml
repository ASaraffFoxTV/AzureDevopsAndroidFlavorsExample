parameters:
  - name: app_name
    type: string
    default: ""
  - name: domain_name
    type: string
    default: ""
  - name: app_secret
    type: string
    default: ""

steps:
  - task: Gradle@2
    inputs:
      workingDirectory: ''
      gradleWrapperFile: 'gradlew'
      gradleOptions: '-Xmx3072m'
      publishJUnitResults: false
      testResultsFiles: '**/TEST-*.xml'
      tasks: 'assembleDebug -Pdomain_name=${{ parameters.domain_name }} -Papp_secret=${{ parameters.app_secret }} -PversionCode=$(Build.BuildNumber)'
  - task: CopyFiles@2
    inputs:
      contents: '**/*.apk'
      targetFolder: '$(build.artifactStagingDirectory)'
  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: '$(build.artifactStagingDirectory)/app/build/outputs/'
      artifactName: 'apk-files-${{ parameters.app_name }}'
      artifactType: 'container'