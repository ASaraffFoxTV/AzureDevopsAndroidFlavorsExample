parameters:
  - name: gradle_task
    type: string
    default: "lint test :android-apk:assemble"
  - name: unit_tests
    type: boolean
    default: false

steps:
  - task: Gradle@2
    inputs:
      workingDirectory: ''
      gradleWrapperFile: 'gradlew'
      gradleOptions: '-Xmx3072m'
      publishJUnitResults: ${{ parameters.unit_tests }}
      testResultsFiles: '**/TEST-*.xml'
      tasks: '${{ parameters.gradle_task }} -PfoxActiveProduct=$(activeProducts) -PfoxActiveBackend=$(activeBackends) -PfoxActiveDeployment=$(activeDeployments) -PfoxActiveDestination=$(activeDestinations) -PfoxActivePlatform=$(activePlatforms) -PfoxActiveEnvironment=$(activeEnvironments) -PkeyStore=$(keystore) -PkeyStorePassword=$(keystorePassword) -PkeyStoreAlias=$(keystoreAlias) -PkeyStoreAliasPassword=$(keystoreAliasPassword) -PnewRelicKey=$(newRelicKey) -PUAGcmSender=$(UAGcmSenderId) -PUAKey=$(UAKeyProd) -PUASecret=$(UASecretProd) -PsegmentWriteKey=$(segmentWriteKey) -Pfox_lintConfig=$(lintConfig) -PversionCode=$(Build.BuildNumber)'